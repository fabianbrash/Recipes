#Various Powershell commands for installing and configuring a Server core and Server GUI install


#Configure Server core
sconfig

#Powershell AD Join commands 
 
#Check available commands 
Get-command –module ADDSDeployment 
 
#Run Poweshell against remote servers 
invoke-command {install-addsdomaincontroller –domainname ethernuno.intra –credential (get-credential) –computername dc02 
 
#Simplest way of Creating a new Forest 
Install-ADDSForest –DomainName "lab.net" 
 
#Customized Configuration  
Install-ADDSForest –DomainName ‘lab.net’ –CreateDNSDelegation –DomainMode Win2012R2 –ForestMode Win2012R2 –DatabasePath "d:\NTDS" –SYSVOLPath "d:\SYSVOL" –LogPath "e:\Logs"
Install-ADDSForest –DomainName $domain –DomainMode Win2012R2 –ForestMode Win2012R2 -Force -SafeModeAdministratorPassword (convertto-securestring $password -asplaintext -force) –DatabasePath $locationNTDS –SYSVOLPath $locationSYSVOL –LogPath $locationNTDSLogs -verbose

#First you MUST install AD Role on Server
Install-Windowsfeature AD-Domain-Services, DNS

#Join an existing Domain this is the replacment for DCPROMO
Install-ADDSDomainController -DomainName 'awssol.com' -InstallDNS:$True –Credential (Get-Credential) 

#CleanUp commands 
Get-help Uninstall-ADDSDomainController 
 
#Demote Commands 
Uninstall-ADDSDomainController –Forceremoval -Demoteoperationmasterrole 
 
#Set TrustedHost 
Set-Item WSMan:\localhost\Client\TrustedHosts -Value ‘hostname,hostname.local’ –Force 

#Get windows features
Get-Windowsfeature
#Install windows feature
Install-Windowsfeature -Name 'FeatureName' -IncludeAllSubFeature -IncludeManagementTools
Install-Windowsfeature -Name 'FeatureName','FeatureName'


